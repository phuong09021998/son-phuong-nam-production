{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useRef } from 'react';\nimport MainLayout from 'layouts/MainLayout';\nimport GreenBackground from 'components/GreenBackground';\nimport styles from './Shop.module.scss';\nimport axios from 'config/axios';\nimport ProductCard from 'components/ProductCard';\nimport Pagination from '@material-ui/lab/Pagination';\nexport var __N_SSG = true;\nexport default function Shop(_ref) {\n  _s();\n\n  var products = _ref.products,\n      siteInfo = _ref.siteInfo,\n      range = _ref.range;\n\n  var _useState = useState(products),\n      items = _useState[0],\n      setItems = _useState[1];\n\n  var _useState2 = useState('createdAt'),\n      sortBy = _useState2[0],\n      setSortBy = _useState2[1];\n\n  var _useState3 = useState(0),\n      currentPagination = _useState3[0],\n      setCurrentPagination = _useState3[1];\n\n  var isFirstRun = useRef(true);\n  var count = Math.floor(range / 9 + 1);\n\n  var handleSelectChange = function handleSelectChange(e) {\n    setSortBy(e.target.value);\n  }; // @ts-ignore\n\n\n  var handlePagination = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e, value) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setCurrentPagination(value - 1);\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handlePagination(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n      return;\n    }\n\n    axios.get(\"/products?limit=9&sortBy=\".concat(sortBy, \"&order=desc&skip=\").concat(currentPagination * 9)).then(function (items) {\n      return setItems(items.data.products);\n    });\n  }, [sortBy, currentPagination]);\n  return __jsx(MainLayout, {\n    title: \"C\\u1EEDa h\\xE0ng | S\\u01A1n Ph\\u01B0\\u01A1ng Nam\",\n    contacts: siteInfo\n  }, __jsx(GreenBackground, {\n    name: \"C\\u1EEDa h\\xE0ng\",\n    breadcrumb: \"Trang ch\\u1EE7 / C\\u1EEDa h\\xE0ng\"\n  }), __jsx(\"div\", {\n    className: styles.selectWrapper\n  }, __jsx(\"div\", {\n    className: styles.select\n  }, __jsx(\"select\", {\n    name: \"sortBy\",\n    onChange: function onChange(e) {\n      return handleSelectChange(e);\n    },\n    defaultValue: \"name\"\n  }, __jsx(\"option\", {\n    value: \"name\"\n  }, \"L\\u1ECDc theo t\\xEAn\"), __jsx(\"option\", {\n    value: \"price\"\n  }, \"L\\u1ECDc theo gi\\xE1\"), __jsx(\"option\", {\n    value: \"sold\"\n  }, \"B\\xE1n ch\\u1EA1y nh\\u1EA5t\")), __jsx(\"div\", {\n    className: styles.arrow\n  }, __jsx(\"img\", {\n    src: \"/icons/up-and-down.svg\",\n    alt: \"up-and-down\"\n  })))), __jsx(\"div\", {\n    className: styles.products\n  }, items.map(function (item, i) {\n    if (item.publish) {\n      return __jsx(ProductCard, {\n        key: i,\n        name: item.name,\n        price: item.price,\n        salePrice: item.salePrice,\n        available: item.available,\n        urlTitle: item.urlTitle\n      });\n    }\n  })), __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center'\n    }\n  }, __jsx(Pagination, {\n    count: count,\n    color: \"secondary\",\n    onChange: handlePagination\n  })));\n}\n\n_s(Shop, \"TkU/wsLkNRYd3boly0E+WY57mKA=\");\n\n_c = Shop;\n\nvar _c;\n\n$RefreshReg$(_c, \"Shop\");","map":{"version":3,"sources":["/media/robert/DATA/Work/web-project/phuong-nam/src-code/pages/cua-hang/index.tsx"],"names":["React","useState","useEffect","useRef","MainLayout","GreenBackground","styles","axios","ProductCard","Pagination","Shop","products","siteInfo","range","items","setItems","sortBy","setSortBy","currentPagination","setCurrentPagination","isFirstRun","count","Math","floor","handleSelectChange","e","target","value","handlePagination","current","get","then","data","selectWrapper","select","arrow","map","item","i","publish","name","price","salePrice","available","urlTitle","display","justifyContent"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport MainLayout from 'layouts/MainLayout';\nimport GreenBackground from 'components/GreenBackground';\nimport styles from './Shop.module.scss';\nimport axios from 'config/axios';\nimport ProductCard from 'components/ProductCard';\nimport Pagination from '@material-ui/lab/Pagination';\n\nexport default function Shop({ products, siteInfo, range }: any) {\n  const [items, setItems] = useState(products);\n  const [sortBy, setSortBy] = useState('createdAt');\n  const [currentPagination, setCurrentPagination] = useState(0);\n  const isFirstRun = useRef(true);\n  const count = Math.floor(range / 9 + 1);\n\n  const handleSelectChange = (e: any) => {\n    setSortBy(e.target.value);\n  };\n\n  // @ts-ignore\n  const handlePagination = async (e: any, value: number) => {\n    setCurrentPagination(value - 1);\n  };\n\n  useEffect(() => {\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n      return;\n    }\n    axios\n      .get(`/products?limit=9&sortBy=${sortBy}&order=desc&skip=${currentPagination * 9}`)\n      .then((items) => setItems(items.data.products));\n  }, [sortBy, currentPagination]);\n\n  return (\n    <MainLayout title=\"Cửa hàng | Sơn Phương Nam\" contacts={siteInfo}>\n      <GreenBackground name=\"Cửa hàng\" breadcrumb=\"Trang chủ / Cửa hàng\" />\n      <div className={styles.selectWrapper}>\n        <div className={styles.select}>\n          <select name=\"sortBy\" onChange={(e) => handleSelectChange(e)} defaultValue=\"name\">\n            <option value=\"name\">Lọc theo tên</option>\n            <option value=\"price\">Lọc theo giá</option>\n            <option value=\"sold\">Bán chạy nhất</option>\n          </select>\n          <div className={styles.arrow}>\n            <img src=\"/icons/up-and-down.svg\" alt=\"up-and-down\" />\n          </div>\n        </div>\n      </div>\n      <div className={styles.products}>\n        {items.map((item: any, i: number) => {\n          if (item.publish) {\n            return (\n              <ProductCard\n                key={i}\n                name={item.name}\n                price={item.price}\n                salePrice={item.salePrice}\n                available={item.available}\n                urlTitle={item.urlTitle}\n              />\n            );\n          }\n        })}\n      </div>\n      <div style={{ display: 'flex', justifyContent: 'center' }}>\n        <Pagination count={count} color=\"secondary\" onChange={handlePagination} />\n      </div>\n    </MainLayout>\n  );\n}\n\nexport async function getStaticProps() {\n  const products = await axios.get('/products?limit=9&skip=0&sortBy=sold&order=desc');\n  const siteInfo = await axios.get('/site/info');\n  const range = await axios.get('/productrange');\n\n  return {\n    props: {\n      products: products.data.products,\n      siteInfo: siteInfo.data.site.siteInfo,\n      range: range.data.range,\n    },\n    revalidate: 1,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}