{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect, useRef } from 'react';\nimport MainLayout from 'layouts/MainLayout';\nimport GreenBackground from 'components/GreenBackground';\nimport styles from './Shop.module.scss';\nimport axios from 'config/axios';\nimport ProductCard from 'components/ProductCard';\nimport Pagination from '@material-ui/lab/Pagination';\nexport default function Shop({\n  products,\n  siteInfo,\n  range\n}) {\n  const {\n    0: items,\n    1: setItems\n  } = useState(products);\n  const {\n    0: sortBy,\n    1: setSortBy\n  } = useState('createdAt');\n  const {\n    0: currentPagination,\n    1: setCurrentPagination\n  } = useState(0);\n  const isFirstRun = useRef(true);\n  const count = Math.floor(range / 9 + 1);\n\n  const handleSelectChange = e => {\n    setSortBy(e.target.value);\n  }; // @ts-ignore\n\n\n  const handlePagination = async (e, value) => {\n    setCurrentPagination(value - 1);\n  };\n\n  useEffect(() => {\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n      return;\n    }\n\n    axios.get(`/products?limit=9&sortBy=${sortBy}&order=desc&skip=${currentPagination * 9}`).then(items => setItems(items.data.products));\n  }, [sortBy, currentPagination]);\n  return __jsx(MainLayout, {\n    title: \"C\\u1EEDa h\\xE0ng | S\\u01A1n Ph\\u01B0\\u01A1ng Nam\",\n    contacts: siteInfo\n  }, __jsx(GreenBackground, {\n    name: \"C\\u1EEDa h\\xE0ng\",\n    breadcrumb: \"Trang ch\\u1EE7 / C\\u1EEDa h\\xE0ng\"\n  }), __jsx(\"div\", {\n    className: styles.selectWrapper\n  }, __jsx(\"div\", {\n    className: styles.select\n  }, __jsx(\"select\", {\n    name: \"sortBy\",\n    onChange: e => handleSelectChange(e),\n    defaultValue: \"name\"\n  }, __jsx(\"option\", {\n    value: \"name\"\n  }, \"L\\u1ECDc theo t\\xEAn\"), __jsx(\"option\", {\n    value: \"price\"\n  }, \"L\\u1ECDc theo gi\\xE1\"), __jsx(\"option\", {\n    value: \"sold\"\n  }, \"B\\xE1n ch\\u1EA1y nh\\u1EA5t\")), __jsx(\"div\", {\n    className: styles.arrow\n  }, __jsx(\"img\", {\n    src: \"/icons/up-and-down.svg\",\n    alt: \"up-and-down\"\n  })))), __jsx(\"div\", {\n    className: styles.products\n  }, items.map((item, i) => {\n    if (item.publish) {\n      return __jsx(ProductCard, {\n        key: i,\n        name: item.name,\n        price: item.price,\n        salePrice: item.salePrice,\n        available: item.available,\n        urlTitle: item.urlTitle\n      });\n    }\n  })), __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center'\n    }\n  }, __jsx(Pagination, {\n    count: count,\n    color: \"secondary\",\n    onChange: handlePagination\n  })));\n}\nexport async function getStaticProps() {\n  const products = await axios.get('/products?limit=9&skip=0&sortBy=sold&order=desc');\n  const siteInfo = await axios.get('/site/info');\n  const range = await axios.get('/productrange');\n  return {\n    props: {\n      products: products.data.products,\n      siteInfo: siteInfo.data.site.siteInfo,\n      range: range.data.range\n    },\n    revalidate: 1\n  };\n}","map":null,"metadata":{},"sourceType":"module"}